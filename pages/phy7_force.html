<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bondona Tutor ‚Äî Physics ‚Ä¢ Chapter 7: Force</title>
  <style>
    :root{ --bg:#f6fbff; --card:#ffffff; --ink:#0b3b5a; --muted:#4d6b80; --accent:#26a6ff; --good:#14b86e; --bad:#ff4d6d; --ring:#d9eefb; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;background:linear-gradient(180deg,var(--bg),#e9f6ff 70%);color:var(--ink)}
    .wrap{max-width:1100px;margin:auto;padding:20px}
    .card{background:var(--card);border-radius:20px;box-shadow:0 10px 30px rgba(13,71,161,.08);padding:20px}
    h1{margin:0 0 6px 0}
    .tag{display:inline-block;background:#eaf7ff;border-radius:999px;padding:4px 10px;color:#1673a6;font-size:12px}
    .grid{display:grid;grid-template-columns: 1fr;gap:20px}
    .speech{position:relative;background:#fff;border:2px solid #d9eefb;border-radius:18px;padding:16px;min-height:120px}
    .controls{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    button{appearance:none;border:none;background:var(--accent);color:#fff;padding:10px 14px;border-radius:12px;font-weight:700;cursor:pointer;box-shadow:0 6px 16px rgba(38,166,255,.24)}
    button.ghost{background:#eaf7ff;color:#0b5a8a;box-shadow:none}
    .muted{color:#4d6b80;font-size:13px}
    .pill{display:inline-block;padding:2px 10px;border-radius:999px;background:#eef7ff;border:1px solid #cfeeff;color:#0b3b5a;font-size:12px}
    .sim{background:#fff;border:2px solid #d9eefb;border-radius:16px;padding:16px}
    .panel{display:grid;grid-template-columns: 320px 1fr;gap:16px;align-items:stretch}
    .explorer{position:relative;height:480px;border:2px dashed var(--ring);border-radius:16px;overflow:hidden;background:radial-gradient(circle at center, #ffffff 0, #f7fbff 70%)}
    .viewport{position:absolute;left:0;top:0;transform-origin:0 0;cursor:grab;will-change:transform;backface-visibility:hidden;transform:translateZ(0)}
    .viewport:active{cursor:grabbing}
    .legend{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
    .side{background:#f8fcff;border:1px solid #d9eefb;border-radius:12px;padding:10px}
    .side h4{margin:0 0 6px 0}
    .side .row{display:grid;grid-template-columns: 1fr auto;align-items:center;gap:8px}
    .list{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:6px;margin-top:8px}
    svg *{vector-effect:non-scaling-stroke;shape-rendering:geometricPrecision}
    svg .org{cursor:pointer;transition:filter .2s ease}
    svg .org:hover{filter:brightness(1.08)}
    .quiz{margin-top:18px;background:#fff;border:2px dashed #cfeeff;border-radius:16px;padding:14px}
    .q{margin:10px 0}
    .phet{background:#fff;border:2px solid #d9eefb;border-radius:16px;padding:16px}
    .phet-frame{position:relative;width:100%;height:560px;border-radius:12px;overflow:hidden}
    iframe.phet-embed{width:100%;height:100%;border:0;display:block}
    .warn{background:#fffceb;border:1px solid #ffe08a;border-radius:10px;padding:10px}
    .pulse{position:relative}
    .pulse::after{content:"";position:absolute;inset:-8px;border:2px solid #cfeeff;border-radius:999px;opacity:.6;animation:pulse 1.8s ease-out infinite}
    @keyframes pulse{0%{transform:scale(.85);opacity:.6}70%{transform:scale(1.15);opacity:0}100%{transform:scale(1.15);opacity:0}}
    .mini{font-size:12px;color:#4d6b80}
  </style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <h1>Physics ‚Ä¢ Chapter 7: Force</h1>
    <div class="tag">Push/Pull ‚Ä¢ Types of Forces ‚Ä¢ Free‚ÄëBody Diagrams ‚Ä¢ Friction ‚Ä¢ Mass vs Weight ‚Ä¢ Newton‚Äôs Laws</div>

    <div class="grid">
      <!-- Story / Overview -->
      <section>
        <div class="speech" id="speech"></div>
        <div class="controls">
          <button id="btnPrev" class="ghost">‚óÅ Prev</button>
          <button id="btnNext">Next ‚ñ∑</button>
          <button id="btnEnable" class="ghost">üîä Enable Audio</button>
          <button id="btnSpeak">‚ñ∂ Narrate (Male)</button>
          <span class="muted" id="lineInfo"></span>
        </div>
      </section>

      <!-- Zoomable Explorer -->
      <section class="sim">
        <h3>Lab: Force Explorer</h3>
        <div class="panel">
          <div class="side">
            <div class="row"><h4>Choose Board</h4>
              <select id="boardType" style="padding:8px;border:2px solid #cfeeff;border-radius:10px;font-weight:700;color:#0b3b5a">
                <option value="basics">Basics & Effects</option>
                <option value="types">Types of Forces</option>
                <option value="fbd">Free‚ÄëBody Diagrams</option>
                <option value="friction">Friction</option>
                <option value="massweight">Mass vs Weight</option>
              </select>
            </div>
            <div class="row" style="margin-top:8px"><span class="pill">Zoom: <span id="zoomLabel">100%</span></span>
              <input id="zoom" type="range" min="80" max="200" value="100" step="5">
            </div>
            <div class="legend">
              <span class="pill">Tap items ‚Üí hear + learn</span>
              <button id="btnCenter" class="ghost">üéØ Center</button>
              <button id="btnMute" class="ghost">üîá Mute</button>
            </div>
            <div class="side" id="infoBox" style="margin-top:10px">
              <h4 id="orgName">Tap an item</h4>
              <div id="orgDesc" class="muted">I will tell you what it means.</div>
              <div class="controls" style="margin-top:8px"><button id="orgSpeak" class="ghost">‚ñ∂ Speak</button></div>
            </div>

            <div class="list" id="legendList"></div>
          </div>

          <div class="explorer" id="explorer">
            <div class="viewport" id="viewport">
              <svg id="boardSVG" viewBox="0 0 1100 760" width="1100" height="760" aria-label="Force boards"></svg>
            </div>
          </div>
        </div>
        <p class="muted">Tip: Use the slider to zoom. Drag the background to pan. Tap a card or vector to hear and learn. Switch boards from the dropdown.</p>
      </section>

      <!-- PhET Forces & Motion: Basics (online + fallbacks) -->
      <section class="phet">
        <h3>Interactive: PhET ‚Äî Forces & Motion: Basics</h3>
        <div class="phet-frame">
          <iframe
            id="phetFrame"
            class="phet-embed"
            title="PhET Forces and Motion Basics"
            src="https://phet.colorado.edu/sims/html/forces-and-motion-basics/latest/forces-and-motion-basics_en.html"
            allow="fullscreen; gamepad; xr-spatial-tracking; clipboard-read; clipboard-write"
            sandbox="allow-scripts allow-forms allow-same-origin allow-pointer-lock allow-popups allow-downloads"
            loading="lazy"
            referrerpolicy="no-referrer-when-downgrade"
          ></iframe>
        </div>
        <div class="controls" style="margin-top:10px">
          <button id="btnPhETNewTab" class="ghost">üîó Open in New Tab (if blocked)</button>
          <button id="btnPhETLocal" class="ghost" title="Use a local copy you downloaded">üíæ Use Local Copy</button>
          <span id="phetStatus" class="muted"></span>
        </div>
        <div class="warn" style="margin-top:10px">
          Offline? Download the HTML5 sim and serve it via a local HTTP server. Example:
          <code>http://127.0.0.1/phet/forces-and-motion-basics_en.html</code> (iframes from <code>file://</code> are blocked).
        </div>
      </section>

      <!-- Mini Interactive (offline srcdoc) -->
      <section class="phet">
        <h3>Mini Interactive: Push a Block (F = ma with friction)</h3>
        <div class="phet-frame">
          <iframe class="phet-embed" title="Block push mini" srcdoc='<!doctype html><html><head><meta charset="utf-8"><style>body{font-family:system-ui;margin:0;padding:14px;color:#0b3b5a;background:#fff} .row{display:flex;gap:12px;align-items:center;flex-wrap:wrap} .card{border:1px solid #cfeeff;border-radius:12px;padding:12px;margin-top:10px} input[type=range]{width:220px} canvas{border:1px solid #cfeeff;border-radius:8px;background:#fff} .pill{display:inline-block;padding:2px 10px;border-radius:999px;background:#eef7ff;border:1px solid #cfeeff} </style></head><body><div class="row"><label>Mass (kg): <input id="m" type="range" min="1" max="20" value="5"></label><span class="pill" id="mv">5 kg</span></div><div class="row"><label>Applied force (N): <input id="fa" type="range" min="0" max="100" value="30"></label><span class="pill" id="fav">30 N</span></div><div class="row"><label>Œº (friction): <input id="mu" type="range" min="0" max="100" value="20"></label><span class="pill" id="muv">0.20</span></div><div class="card"><b>a</b> = <span id="a">0.00</span> m/s¬≤ ‚Ä¢ <b>F_net</b> = <span id="fnet">0.00</span> N</div><canvas id="cv" width="680" height="220"></canvas><script>const g=9.8; const $=id=>document.getElementById(id); const cv=$("cv"); const ctx=cv.getContext("2d"); function upd(){const m=+$("m").value; const Fa=+$("fa").value; const mu=+$("mu").value/100; $("mv").textContent=m+" kg"; $("fav").textContent=Fa+" N"; $("muv").textContent=mu.toFixed(2); const N=m*g; const Ff_max=mu*N; let Ff=Math.min(Ff_max, Fa); let Fnet=Fa - Ff; if (Fa < Ff_max) Fnet=0; const a=Fnet/m; $("a").textContent=a.toFixed(2); $("fnet").textContent=Fnet.toFixed(2); draw(m,Fa,mu,Ff,Fnet,a);} function arrow(x,y,len,lab){ctx.beginPath(); ctx.moveTo(x,y); ctx.lineTo(x+len,y); ctx.stroke(); ctx.beginPath(); ctx.moveTo(x+len,y); ctx.lineTo(x+len-8,y-5); ctx.lineTo(x+len-8,y+5); ctx.closePath(); ctx.fill(); ctx.fillText(lab, x+len/2-10, y-8);} function draw(m,Fa,mu,Ff,Fnet,a){ctx.clearRect(0,0,cv.width,cv.height); ctx.fillStyle="#eef7ff"; ctx.fillRect(0,150,680,50); ctx.strokeStyle="#0b3b5a"; ctx.fillStyle="#0b3b5a"; ctx.lineWidth=2; ctx.strokeRect(260,120,80,50); ctx.fillText("m="+m+" kg", 265, 115); arrow(220,145,-60,-"F_f"+"="+Ff.toFixed(1)+"N"); arrow(340,145,Math.min(160,Fa),"F_a"); ctx.strokeStyle="#14b86e"; ctx.fillStyle="#14b86e"; arrow(300,190,Math.max(-160,Math.min(160,Fnet)),"F_net"); ctx.fillStyle="#0b3b5a"; ctx.fillText("a="+a.toFixed(2)+" m/s¬≤", 20, 20);} ["m","fa","mu"].forEach(id=>$(id).addEventListener("input",upd)); upd(); </script></body></html>'></iframe>
        </div>
        <p class="mini">Note: Static friction cancels applied force up to ŒºN. Once Fa > ŒºN, the block accelerates with (Fa ‚àí ŒºN)/m.</p>
      </section>

      <!-- Quiz -->
      <section class="quiz" id="quiz"></section>

    </div>
  </div>
</div>

<script>
// ----------------------
// Story lines
// ----------------------
const LINES = [
  "A force is a push or a pull. It can change the state of motion or shape of an object.",
  "Balanced forces produce no change in motion; unbalanced forces cause acceleration.",
  "Types: contact (friction, normal, tension) and non‚Äëcontact (gravitational, magnetic, electrostatic).",
  "A free‚Äëbody diagram (FBD) shows all forces on a single object with arrows.",
  "Friction opposes motion or attempted motion; its size depends on the normal reaction and the surfaces.",
  "Mass is the amount of matter (kg); weight is the gravitational force W = m g (newtons)."
];

// ----------------------
// Quiz bank
// ----------------------
const QUIZ = [
  {q:"Which pair are non‚Äëcontact forces?",a:["Tension & Normal","Friction & Spring","Gravitational & Electrostatic"],correct:2},
  {q:"Balanced forces on a body mean‚Ä¶",a:["Velocity stays same","Acceleration increases","It must be at rest"],correct:0},
  {q:"On a horizontal table, which forces act on a resting block?",a:["Weight and Normal","Only weight","Weight, Normal and Thrust"],correct:0},
  {q:"Friction is approximately proportional to‚Ä¶",a:["Contact area","Normal reaction","Volume"],correct:1},
  {q:"A 10 kg mass near Earth has weight ‚âà",a:["10 N","98 N","1000 N"],correct:1}
];

// ----------------------
// TTS (male-preferred) with priming
// ----------------------
let currentIdx = 0; let voices = []; let muted=false; let audioEnabled=false;
const speechBox = document.getElementById('speech');
const lineInfo = document.getElementById('lineInfo');
const btnSpeak = document.getElementById('btnSpeak');
const btnNext = document.getElementById('btnNext');
const btnPrev = document.getElementById('btnPrev');
const btnMute = document.getElementById('btnMute');
const btnEnable = document.getElementById('btnEnable');

function renderLine(){ speechBox.textContent = LINES[currentIdx]; lineInfo.textContent = `Line ${currentIdx+1} of ${LINES.length}`; }
function loadVoices(){ try{ voices = window.speechSynthesis.getVoices(); }catch(e){ voices = []; } }
function pickMaleVoice(){ if(!voices.length) return null; const pref=/(male|daniel|george|brian|english male|barry|david|microsoft|google uk|alex)/i; const en=v=>/en/i.test(v.lang||""); return voices.find(v=>pref.test((v.name||"")+" "+(v.lang||""))&&en(v)) || voices.find(en) || voices[0]; }
function speak(text){ if(muted || !audioEnabled) return; if(!('speechSynthesis' in window)) return; try{ window.speechSynthesis.cancel(); const u=new SpeechSynthesisUtterance(text); loadVoices(); const v=pickMaleVoice(); if(v) u.voice=v; u.pitch=1.0; u.rate=1.03; window.speechSynthesis.speak(u);}catch(e){} }
if('speechSynthesis' in window){ loadVoices(); window.speechSynthesis.onvoiceschanged=()=>{ loadVoices(); }; }
btnEnable.addEventListener('click', ()=>{ audioEnabled = true; try{ window.speechSynthesis.cancel(); const u=new SpeechSynthesisUtterance("Audio enabled."); const v=pickMaleVoice(); if(v) u.voice=v; window.speechSynthesis.speak(u);}catch(e){} btnEnable.textContent = "‚úÖ Audio On"; });
btnSpeak.addEventListener('click', ()=>{ speak(LINES[currentIdx]); });
btnNext.addEventListener('click', ()=>{ if(currentIdx<LINES.length-1){ currentIdx++; renderLine(); } });
btnPrev.addEventListener('click', ()=>{ if(currentIdx>0){ currentIdx--; renderLine(); } });
btnMute.addEventListener('click', ()=>{ muted=!muted; btnMute.textContent = muted? 'üîä Unmute' : 'üîá Mute'; if(muted){ try{ window.speechSynthesis.cancel(); }catch(e){} } });

// ----------------------
// Build Quiz
// ----------------------
const qz = document.getElementById('quiz');
function buildQuiz(){ let html = '<h3>Quiz Time! üéâ</h3>'; QUIZ.forEach((item,i)=>{ html += `<div class="q"><b>${i+1}. ${item.q}</b><div>`; item.a.forEach((opt,j)=>{ html += `<label style="display:block;margin:.25rem 0"><input type='radio' name='q${i}' value='${j}'> ${opt}</label>`; }); html += '</div></div>'; }); html += `<div class='controls'><button id='btnCheck' class='good'>Check Answers</button><button id='btnReset' class='ghost'>Reset</button><span id='result' class='muted'></span></div>`; qz.innerHTML = html; document.getElementById('btnCheck').addEventListener('click', checkQuiz); document.getElementById('btnReset').addEventListener('click', ()=>{ qz.querySelectorAll('input[type=radio]').forEach(r=>r.checked=false); document.getElementById('result').textContent=''; }); }
function checkQuiz(){ let score=0; let answered=0; QUIZ.forEach((item,i)=>{ const chosen=qz.querySelector(`input[name='q${i}']:checked`); if(chosen){answered++; if(Number(chosen.value)===item.correct) score++;} }); const r=document.getElementById('result'); if(answered<QUIZ.length){ r.textContent='Pick an answer for each question.'; return; } r.textContent=(score===QUIZ.length)?'üåü Perfect! Force pro!':`Nice! You got ${score} of ${QUIZ.length}.`; }

// ----------------------
// Explorer (pan, zoom, tap)
// ----------------------
const explorer = document.getElementById('explorer');
const viewport = document.getElementById('viewport');
const zoom = document.getElementById('zoom');
const zoomLabel = document.getElementById('zoomLabel');
const btnCenter = document.getElementById('btnCenter');
const orgName = document.getElementById('orgName');
const orgDesc = document.getElementById('orgDesc');
const orgSpeak = document.getElementById('orgSpeak');
const boardType = document.getElementById('boardType');
const svg = document.getElementById('boardSVG');
const legendList = document.getElementById('legendList');

let pan = {x:0,y:0}; let scale = 1;
function applyTransform(){ viewport.style.transform = `translate(${pan.x}px, ${pan.y}px) scale(${scale})`; }
zoom.addEventListener('input', ()=>{ scale = Number(zoom.value)/100; zoomLabel.textContent = `${zoom.value}%`; applyTransform(); });
btnCenter.addEventListener('click', ()=>{ pan.x = (explorer.clientWidth-1100*scale)/2; pan.y = (explorer.clientHeight-760*scale)/2; applyTransform(); });
window.addEventListener('resize', ()=> btnCenter.click());

let panning=false, sx=0, sy=0, ox=0, oy=0;
explorer.addEventListener('pointerdown', e=>{ if(e.target.closest('.org')) return; panning=true; sx=e.clientX; sy=e.clientY; ox=pan.x; oy=pan.y; explorer.setPointerCapture(e.pointerId); });
explorer.addEventListener('pointermove', e=>{ if(!panning) return; const dx=e.clientX-sx, dy=e.clientY-sy; pan.x = ox + dx; pan.y = oy + dy; applyTransform(); });
explorer.addEventListener('pointerup', e=>{ if(panning){ explorer.releasePointerCapture(e.pointerId); } panning=false; });

// ----------------------
// Boards (SVG) and data
// ----------------------
const INFO = {
  // Basics
  def:{name:'Definition of Force',desc:'A force is a push or pull that can change an object\'s motion or shape.'},
  balanced:{name:'Balanced vs Unbalanced',desc:'Balanced forces cancel each other (no acceleration). Unbalanced forces cause acceleration.'},
  effects:{name:'Effects of Force',desc:'Can start/stop motion, change speed/direction, or deform objects.'},
  // Types
  contact:{name:'Contact Forces',desc:'Act when bodies touch: friction, normal reaction, tension, spring force.'},
  noncontact:{name:'Non‚Äëcontact Forces',desc:'Act at a distance: gravitational, electrostatic, magnetic.'},
  tension:{name:'Tension',desc:'Pulling force transmitted through a string, rope, cable, or chain.'},
  normal:{name:'Normal Reaction',desc:'Perpendicular support force exerted by a surface.'},
  // FBD
  fbdblock:{name:'FBD of a Block',desc:'For a block on a table: Weight (mg) down, Normal (N) up, Applied force and Friction horizontal.'},
  vectors:{name:'Force Vectors',desc:'Arrow length shows magnitude, arrow direction shows the line of action.'},
  // Friction
  fricdef:{name:'Friction',desc:'Opposes relative motion or tendency of motion between surfaces in contact.'},
  statickin:{name:'Static vs Kinetic',desc:'Static friction adjusts up to a limit (Œº_s N). Once moving, kinetic friction ‚âà Œº_k N (usually smaller).'},
  reduce:{name:'Reducing Friction',desc:'Use lubrication, smooth surfaces, ball bearings, or streamlined shapes.'},
  // Mass vs Weight
  mass:{name:'Mass',desc:'Amount of matter; scalar; same everywhere; SI unit kilogram (kg).'},
  weight:{name:'Weight',desc:'Gravitational force: W = m g; vector; changes with g; SI unit newton (N).'}
};

const LEGENDS = {
  basics:['Definition','Balanced vs Unbalanced','Effects'],
  types:['Contact','Non‚Äëcontact','Tension','Normal'],
  fbd:['Block FBD','Force Vectors'],
  friction:['What is friction?','Static vs Kinetic','Reduce friction'],
  massweight:['Mass','Weight']
};

function card(x,y,title,key){ return `
  <g class="org" data-key="${key}" role="button" tabindex="0" transform="translate(${x},${y})">
    <rect width="320" height="160" rx="18" fill="#ffffff" stroke="#cfeeff" />
    <text x="16" y="36" font-size="18" font-weight="700" fill="#0b3b5a">${title}</text>
    <text x="16" y="68" font-size="14" fill="#4d6b80">Tap to hear what it means</text>
  </g>`; }

function makeBasics(){ return `
  <rect x="0" y="0" width="1100" height="760" fill="url(#g1)"/>
  <defs><linearGradient id="g1" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#f7fbff"/><stop offset="100%" stop-color="#e9f6ff"/></linearGradient></defs>
  ${card(60,80,'Definition of Force','def')}
  ${card(420,80,'Balanced vs Unbalanced','balanced')}
  ${card(60,280,'Effects of Force','effects')}
  `; }

function makeTypes(){ return `
  <rect x="0" y="0" width="1100" height="760" fill="url(#g2)"/>
  <defs><linearGradient id="g2" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#f7fbff"/><stop offset="100%" stop-color="#e9f6ff"/></linearGradient></defs>
  ${card(60,80,'Contact Forces','contact')}
  ${card(420,80,'Non‚Äëcontact Forces','noncontact')}
  ${card(60,280,'Tension','tension')}
  ${card(420,280,'Normal Reaction','normal')}
  `; }

function makeFBD(){ return `
  <rect x="0" y="0" width="1100" height="760" fill="url(#g3)"/>
  <defs><linearGradient id="g3" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#f7fbff"/><stop offset="100%" stop-color="#e9f6b"/></linearGradient></defs>
  ${card(60,80,'Block FBD','fbdblock')}
  ${card(420,80,'Force Vectors','vectors')}
  <g transform="translate(760,120)" class="org" data-key="vectors" tabindex="0" role="button">
    <rect width="300" height="220" rx="16" fill="#ffffff" stroke="#cfeeff"/>
    <rect x="110" y="120" width="80" height="40" fill="#eef7ff" stroke="#0b3b5a"/>
    <g stroke="#0b3b5a" fill="#0b3b5a" stroke-width="2">
      <line x1="150" y1="160" x2="230" y2="160" />
      <polygon points="230,160 222,155 222,165"/>
      <line x1="150" y1="160" x2="150" y2="100" />
      <polygon points="150,100 145,108 155,108"/>
    </g>
    <text x="20" y="36" font-size="16" fill="#0b3b5a">Vector arrows show magnitude & direction</text>
  </g>
  `; }

function makeFriction(){ return `
  <rect x="0" y="0" width="1100" height="760" fill="url(#g4)"/>
  <defs><linearGradient id="g4" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#f7fbff"/><stop offset="100%" stop-color="#e9f6ff"/></linearGradient></defs>
  ${card(60,80,'What is friction?','fricdef')}
  ${card(420,80,'Static vs Kinetic','statickin')}
  ${card(60,280,'Reducing friction','reduce')}
  `; }

function makeMassWeight(){ return `
  <rect x="0" y="0" width="1100" height="760" fill="url(#g5)"/>
  <defs><linearGradient id="g5" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#f7fbff"/><stop offset="100%" stop-color="#e9f6ff"/></linearGradient></defs>
  ${card(60,80,'Mass','mass')}
  ${card(420,80,'Weight','weight')}
  `; }

function renderBoard(){ const t = boardType.value; let inner=''; if(t==='basics') inner = makeBasics(); if(t==='types') inner = makeTypes(); if(t==='fbd') inner = makeFBD(); if(t==='friction') inner = makeFriction(); if(t==='massweight') inner = makeMassWeight(); svg.innerHTML = inner; buildLegend(t); }
function buildLegend(t){ const items = LEGENDS[t]||[]; legendList.innerHTML = items.map(x=>`<span class="pill">${x}</span>`).join(''); }

// Delegated taps
svg.addEventListener('click', e=>{ const t=e.target.closest('.org'); if(!t) return; const key=t.getAttribute('data-key'); say(key); });
svg.addEventListener('keydown', e=>{ if(e.key==='Enter'||e.key===' '){ const t=e.target.closest('.org'); if(t){ e.preventDefault(); say(t.getAttribute('data-key')); } } });
function say(key){ const d=INFO[key]; if(!d) return; orgName.textContent=d.name; orgDesc.textContent=d.desc; speak(`${d.name}. ${d.desc}`); }
orgSpeak.addEventListener('click', ()=>{ if(orgName.textContent && orgDesc.textContent){ speak(`${orgName.textContent}. ${orgDesc.textContent}`); } });
boardType.addEventListener('change', renderBoard);

// ----------------------
// PhET controls (online + local)
// ----------------------
const phetURL = "https://phet.colorado.edu/sims/html/forces-and-motion-basics/latest/forces-and-motion-basics_en.html";
const phetFrame = document.getElementById("phetFrame");
const phetStatus = document.getElementById("phetStatus");
(document.getElementById("btnPhETNewTab")||{}).onclick = ()=> window.open(phetURL, "_blank");
(document.getElementById("btnPhETLocal")||{}).onclick = ()=>{ const localURL = "http://127.0.0.1/phet/forces-and-motion-basics_en.html"; phetFrame.src = localURL; phetStatus.textContent = "Switched to local copy."; };
setTimeout(()=>{ phetStatus.textContent = "If the panel is blank, click Open in New Tab or Use Local Copy."; }, 2500);

// ----------------------
// Init
// ----------------------
function init(){ renderLine(); buildQuiz(); renderBoard(); btnCenter.click(); }
window.addEventListener('load', init);
</script>
</body>
</html>
